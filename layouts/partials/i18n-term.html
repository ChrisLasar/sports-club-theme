{{/*
  i18n-term.html
  
  Purpose: Resolve UI terminology with multilingual support and config overrides
  
  Input Parameters (dict):
    - key (string, required): Translation key (e.g., "teams", "news")
    - context (any, optional): Page/site context for interpolation
    - count (int, optional): Integer for pluralization
  
  Output: Translated/overridden term or key itself (never empty)
  
  Fallback Chain:
    1. Config Override (site.Language.Params.terms.KEY)
    2. Current Language i18n (i18n KEY)
    3. Default Language i18n (Hugo's automatic fallback)
    4. Key Itself (failsafe)
  
  Usage:
    {{ partial "i18n-term.html" (dict "key" "teams") }}
    {{ partial "i18n-term.html" (dict "key" "no_items_yet" "context" (dict "Type" "teams")) }}
*/}}

{{- $key := .key -}}
{{- $context := .context -}}
{{- $count := .count -}}
{{- $result := "" -}}

{{/* Step 1: Check for config override */}}
{{- with site.Language.Params.terms -}}
  {{- $override := index . $key -}}
  {{- if $override -}}
    {{- $result = $override -}}
  {{- end -}}
{{- end -}}

{{/* Step 2-3: Use Hugo's i18n (handles current language + fallback to default) */}}
{{- if not $result -}}
  {{- if $context -}}
    {{- $result = i18n $key $context -}}
  {{- else if $count -}}
    {{- $result = i18n $key $count -}}
  {{- else -}}
    {{- $result = i18n $key -}}
  {{- end -}}
  
  {{/* Step 4: Fallback to key itself if i18n returns empty or the key itself */}}
  {{- if or (not $result) (eq $result $key) -}}
    {{- $result = $key -}}
  {{- end -}}
{{- end -}}

{{- $result -}}
