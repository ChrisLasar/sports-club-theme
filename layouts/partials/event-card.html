{{- /*
  Event Card Partial
  Displays event cards with status badges, team info, and registration status
  
  Context (dict):
    - event: Page object for the event
*/ -}}

{{ $event := .event }}

<div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow h-full">
  {{ with $event.Resources.GetMatch "featured*" }}
  <figure class="aspect-video overflow-hidden">
    {{- partial "responsive-image.html" (dict "context" $ "src" .RelPermalink "alt" $event.Title "class" "w-full h-full object-cover") -}}
  </figure>
  {{ end }}
  
  <div class="card-body">
    <div class="flex gap-2 flex-wrap mb-2">
      {{ with $event.Params.status }}
        {{ if eq . "upcoming" }}
        <span class="badge badge-primary">Upcoming</span>
        {{ else if eq . "completed" }}
        <span class="badge badge-success">Completed</span>
        {{ else if eq . "cancelled" }}
        <span class="badge badge-error">Cancelled</span>
        {{ else if eq . "postponed" }}
        <span class="badge badge-warning">Postponed</span>
        {{ end }}
      {{ end }}
      
      {{ range $event.Params.teams }}
        {{ with site.GetPage (printf "teams/%s" .) }}
        <span class="badge badge-outline badge-sm">{{ .Title }}</span>
        {{ end }}
      {{ end }}
    </div>
    
    <h3 class="card-title">{{ $event.Title }}</h3>
    
    {{ with $event.Params.date }}
    <p class="text-sm text-base-content/70">
      <time datetime="{{ . }}">{{ dateFormat "January 2, 2006 at 3:04 PM" . }}</time>
    </p>
    {{ end }}
    
    {{ with $event.Params.location }}
    <p class="text-sm flex items-center gap-1">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
      {{ . }}
    </p>
    {{ end }}
    
    {{ with $event.Summary }}
    <p class="text-sm line-clamp-3">{{ . }}</p>
    {{ end }}
    
    {{ if and (eq $event.Params.status "upcoming") (eq $event.Params.registrationRequired true) }}
    <div class="mt-2">
      {{ with $event.Params.registrationDeadline }}
      <p class="text-xs opacity-70">Register by {{ dateFormat "Jan 2, 2006" . }}</p>
      {{ end }}
    </div>
    {{ end }}
    
    <div class="card-actions justify-end mt-4">
      <a href="{{ $event.RelPermalink }}" class="btn btn-sm btn-outline">View Details</a>
    </div>
  </div>
</div>
