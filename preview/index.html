<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preview Deployments</title>
    <style>
        body { font-family: system-ui; max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        h1 { color: #333; }
        .preview-list { display: grid; gap: 1rem; }
        .preview-card { border: 1px solid #ddd; border-radius: 8px; padding: 1rem; }
        .preview-card.success { border-left: 4px solid #22c55e; }
        .preview-card.error { border-left: 4px solid #ef4444; }
        .preview-header { display: flex; justify-content: space-between; align-items: start; }
        .branch-name { font-size: 1.25rem; font-weight: 600; }
        .status { padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem; }
        .status.success { background: #dcfce7; color: #166534; }
        .status.error { background: #fee2e2; color: #991b1b; }
        .commit-info { color: #666; font-size: 0.875rem; margin-top: 0.5rem; }
        .actions { margin-top: 1rem; display: flex; gap: 0.5rem; }
        .btn { padding: 0.5rem 1rem; text-decoration: none; border-radius: 4px; font-size: 0.875rem; }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-secondary { background: #e5e7eb; color: #374151; }
    </style>
</head>
<body>
    <h1>ðŸš€ Preview Deployments</h1>
    <p>Active preview deployments for feature branches</p>
    <div class="preview-list" id="previews">Loading...</div>
    
    <script>
        fetch('.preview-list.json')
            .then(r => r.json())
            .then(data => {
                const container = document.getElementById('previews');
                if (data.total_previews === 0) {
                    container.innerHTML = '<p>No active previews</p>';
                    return;
                }
                
                container.innerHTML = data.previews.map(p => `
                    <div class="preview-card ${p.build_status}">
                        <div class="preview-header">
                            <div class="branch-name">${p.branch}</div>
                            <span class="status ${p.build_status}">${p.build_status}</span>
                        </div>
                        <div class="commit-info">
                            <div>${p.commit_message}</div>
                            <div>by ${p.author} â€¢ ${new Date(p.timestamp).toLocaleString()}</div>
                        </div>
                        <div class="actions">
                            ${p.build_status === 'success' 
                                ? `<a href="${p.url}" class="btn btn-primary">View Preview</a>`
                                : `<a href="${p.url}error.html" class="btn btn-secondary">View Error</a>`
                            }
                            <a href="https://github.com/ChrisLasar/sports-club-theme/commit/${p.commit}" class="btn btn-secondary">View Commit</a>
                        </div>
                    </div>
                `).join('');
            })
            .catch(err => {
                document.getElementById('previews').innerHTML = '<p>Error loading previews</p>';
            });
    </script>
</body>
</html>
